<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for Charge Migration">
    <meta name="author" content="" >
    <link rel="icon" href="../favicon.png">

    <title>Module_Becke &ndash; Charge Migration</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE=" crossorigin="anonymous"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Charge Migration </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>Module_Becke
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip"
                 data-bs-placement="bottom" data-html="true"
                 title=" 7.1% of total for modules and submodules.">102 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/Module_Becke.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/module_becke.f90.html'>Module_Becke.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">Module_Becke</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#funcs-0"
         aria-expanded="false" aria-controls="funcs-0">
         <h4 class="card-header bg-primary text-white">Functions</h4>
      </a>
      <div id="funcs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/module_becke.html#proc-eucldist">EuclDist</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-ellipticalcoord">EllipticalCoord</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-radius_table">Radius_Table</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-get_param_a">get_param_a</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-new_mu_transformation">new_mu_transformation</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-fkfun">fkfun</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-skfun">skfun</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-skfunab">skfunab</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-pkfuna">Pkfuna</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-pkfuntot">PkFunTot</a>
            <a class="list-group-item" href="../module/module_becke.html#proc-wkfun">wkfun</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      <p>This code is a Fortran implementation of the Becke partitioning scheme based on the following papers:</p>
<p>H. Gharibnejad, N. Douguet, B.I. Schneider, J. Olsen, L. Argenti,
  A multi-center quadrature scheme for the molecular continuum,
  Computer Physics Communications, Volume 263, 2021, 107889, ISSN 0010-4655,
  https://doi.org/10.1016/j.cpc.2021.107889.</p>
<p>and</p>
<p>A. D. Becke; A multicenter numerical integration scheme for polyatomic molecules.
  J. Chem. Phys. 15 February 1988; 88 (4): 2547â€“2553. https://doi.org/10.1063/1.454033</p>
<hr>
<p>
<script type="math/tex">Result = P_a(\vec{r})/\sum_bP_b(\vec{r}) </script>
</p>
<hr>
<p>Quick Notes:</p>
<p>Radius_Table: Given the name of an atom, returns its atomic radius. Only supports H, C, N, O, and Mg.</p>
<p>get_param_a: Given two radii R_i and R_j, returns a transformed parameter a_ij. If the absolute value of <script type="math/tex">a_{ij}</script> is greater than 0.5, it's set to 0.5.</p>
<p>new_mu_transformation: Returns a new mu parameter, given the original mu and <script type="math/tex">a_{ij}</script>.</p>
<p>wkfun: Calculates a weighted function for atom i.</p>
<p>PkFunTot: Sums up the function Pkfuna over all atoms.</p>
<p>Pkfuna: Calculates a product of skfunab over all atoms excluding atom i.</p>
<p>skfunab: Transforms an elliptical coordinate to a new mu, then returns the result of skfun with this new mu.</p>
<p>skfun: Transforms a mu parameter into a step function.</p>
<p>fkfun: Recursively calculates a function of mu.</p>
<p>EllipticalCoord: Given coordinates rvec, avec, and bvec, calculates an elliptical coordinate.</p>
<p>EuclDist: Given two points in space, calculates their Euclidean distance.</p>
<p>The main considerations:
This code does not handle the case where the input atomic name does not match one of the provided options in Radius_Table. This could lead to an error or unexpected behavior.
The recursion in fkfun does not seem to have a base case when k is less than 1, which could potentially lead to a stack overflow error.
There are no checks for zero or negative distances in EuclDist which might cause issues if not handled properly upstream.
The input values are not validated for possible errors. Adding error handling and input validation could make the code more robust.
The functions are tightly coupled, which might make modifications and debugging more difficult.</p>
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='http://fortranwiki.org/fortran/show/iso_fortran_env'>iso_fortran_env</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: module~~module_becke~~UsesGraph Pages: 1 -->
<svg id="modulemodule_beckeUsesGraph" width="228pt" height="32pt"
 viewBox="0.00 0.00 228.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="module~~module_becke~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>module~~module_becke~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 224,-28 224,4 -4,4"/>
<!-- module~module_becke -->
<g id="module~~module_becke~~UsesGraph_node1" class="node">
<title>module~module_becke</title>
<polygon fill="none" stroke="black" points="220,-24 130,-24 130,0 220,0 220,-24"/>
<text text-anchor="middle" x="175" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">Module_Becke</text>
</g>
<!-- iso_fortran_env -->
<g id="module~~module_becke~~UsesGraph_node2" class="node">
<title>iso_fortran_env</title>
<polygon fill="#337ab7" stroke="#337ab7" points="94,-24 0,-24 0,0 94,0 94,-24"/>
<text text-anchor="middle" x="47" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</g>
<!-- module~module_becke&#45;&gt;iso_fortran_env -->
<g id="module~~module_becke~~UsesGraph_edge1" class="edge">
<title>module~module_becke&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M129.93,-12C121.76,-12 113.12,-12 104.63,-12"/>
<polygon fill="#000000" stroke="#000000" points="104.4,-8.5 94.4,-12 104.4,-15.5 104.4,-8.5"/>
</g>
</g>
</svg>
</div>        <div><a type="button" class="graph-help" data-toggle="modal" href="#UsesGraph-help-text">Help</a></div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                </div>
              <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 </div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>

          <div class="card">
      <h3 class="card-header card-title bg-light">Used by</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: module~~module_becke~~UsedByGraph Pages: 1 -->
<svg id="modulemodule_beckeUsedByGraph" width="236pt" height="32pt"
 viewBox="0.00 0.00 236.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="module~~module_becke~~UsedByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>module~~module_becke~~UsedByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 232,-28 232,4 -4,4"/>
<!-- module~module_becke -->
<g id="module~~module_becke~~UsedByGraph_node1" class="node">
<title>module~module_becke</title>
<polygon fill="none" stroke="black" points="90,-24 0,-24 0,0 90,0 90,-24"/>
<text text-anchor="middle" x="45" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">Module_Becke</text>
</g>
<!-- program~chargemigration -->
<g id="module~~module_becke~~UsedByGraph_node2" class="node">
<title>program~chargemigration</title>
<g id="a_module~~module_becke~~UsedByGraph_node2"><a xlink:href=".././program/chargemigration.html" xlink:title="ChargeMigration">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="228,-24 126,-24 126,0 228,0 228,-24"/>
<text text-anchor="middle" x="177" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ChargeMigration</text>
</a>
</g>
</g>
<!-- program~chargemigration&#45;&gt;module~module_becke -->
<g id="module~~module_becke~~UsedByGraph_edge1" class="edge">
<title>program~chargemigration&#45;&gt;module~module_becke</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M125.74,-12C117.41,-12 108.74,-12 100.31,-12"/>
<polygon fill="#000000" stroke="#000000" points="100.2,-8.5 90.2,-12 100.2,-15.5 100.2,-8.5"/>
</g>
</g>
</svg>
</div>        <div><a type="button" class="graph-help" data-toggle="modal" href="#UsedByGraph-help-text">Help</a></div>
          <div class="modal fade" id="UsedByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                </div>
              <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 </div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>

      <br>







        <section>
          <h2>Functions</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-eucldist"></span><h3>public  function <a href='../proc/eucldist.html'>EuclDist</a>(avec, bvec) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function calculates the Euclidean distance between two points in 3D space. The inputs are two 3-component vectors representing the coordinates of the points, and the output is a scalar representing the distance between them.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-avec"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>avec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bvec"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bvec</strong>(3)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-ellipticalcoord"></span><h3>public  function <a href='../proc/ellipticalcoord.html'>EllipticalCoord</a>(rvec, avec, bvec) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>Eq. 1 <script type="math/tex"> \mu_{ab}(\vec{r}) </script>
This function calculates the elliptical coordinate (<script type="math/tex">\mu_{ab}</script>) of a point relative to two other points (defined as atoms 'a' and 'b'). This coordinate is a measure of how much closer the point is to atom 'a' compared to atom 'b'.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-rvec"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rvec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-avec~2"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>avec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bvec~2"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bvec</strong>(3)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-radius_table"></span><h3>public  function <a href='../proc/radius_table.html'>Radius_Table</a>(Atomic_Name) result(Atomic_Radius)  
</h3></div>
    <div class="card-body">
          
  <p>Radius_Table for atomic radius based on atomic name
This function provides the atomic radius based on the atomic name. The input is a string representing the atomic name and the output is the corresponding atomic radius. This is useful for defining the size of atoms in molecular modelling.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-atomic_name"></span>
              character(len=16),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Atomic_Name</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-get_param_a"></span><h3>public  function <a href='../proc/get_param_a.html'>get_param_a</a>(R_i, R_j) result(a_ij)  
</h3></div>
    <div class="card-body">
          
  <p>This function calculates the parameter 'a' (<script type="math/tex">a_{ij}</script>) which depends on the radii of two atoms. This parameter is used in the transformation of the elliptical coordinate.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-r_i"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>R_i</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-r_j"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>R_j</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-new_mu_transformation"></span><h3>public  function <a href='../proc/new_mu_transformation.html'>new_mu_transformation</a>(mu, a_ij) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function transforms the elliptical coordinate using the parameter 'a' (<script type="math/tex">a_{ij}</script>). This transformation is used to handle cases where the point is much closer to one atom than the other.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-mu"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mu</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a_ij~2"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>a_ij</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-fkfun"></span><h3>public recursive function <a href='../proc/fkfun.html'>fkfun</a>(mu, k) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>Eq. 4 Recursive  <script type="math/tex"> f_k(\mu) </script>
This function calculates a recursive function of the transformed elliptical coordinate. The output of this function will be used in the calculation of the step function skfun.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-mu~2"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mu</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-skfun"></span><h3>public  function <a href='../proc/skfun.html'>skfun</a>(mu, k) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>
<script type="math/tex"> s(\mu): [-1,1]  \rightarrow [0,1] </script>  (Step Function)
This function calculates a step function of the transformed elliptical coordinate. This function maps the transformed elliptical coordinate from the range [-1,1] to [0,1].</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-mu~3"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mu</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-skfunab"></span><h3>public  function <a href='../proc/skfunab.html'>skfunab</a>(rvec, avec, bvec, k, a_ij) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>This function combines the calculations of the transformed elliptical coordinate and the step function. The output of this function will be used in the calculation of the partial partition function Pkfuna.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-rvec~2"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rvec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-avec~3"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>avec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bvec~3"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bvec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a_ij~3"></span>
              real(kind=kind(1d0))
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>a_ij</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-pkfuna"></span><h3>public  function <a href='../proc/pkfuna.html'>Pkfuna</a>(rvec, iAtom, AtCoord, nAtoms, k, Radius_BS) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>Eq. 2  <script type="math/tex"> P_a(\vec{r}) </script>, nominator of Eq. 3
This function calculates the partial partition function for a specific atom. The output of this function represents the contribution of a specific atom to the total partition function.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-rvec~3"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rvec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iatom"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iAtom</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atcoord"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>AtCoord</strong>(3,nAtoms)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-natoms~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nAtoms</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-radius_bs"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Radius_BS</strong>(:)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-pkfuntot"></span><h3>public  function <a href='../proc/pkfuntot.html'>PkFunTot</a>(rvec, AtCoord, nAtoms, k, Radius_BS) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>Eq. 3 <script type="math/tex"> \sum_bP_b(\vec{r}) </script> in the denominator
This function calculates the total partition function. This is done by summing the partial partition functions for all atoms.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-rvec~4"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rvec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atcoord~2"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>AtCoord</strong>(3,nAtoms)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-natoms~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nAtoms</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-radius_bs~2"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Radius_BS</strong>(:)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-wkfun"></span><h3>public  function <a href='../proc/wkfun.html'>wkfun</a>(rvec, iAtom, AtCoord, nAtoms, k, Radius_BS) result(res)  
</h3></div>
    <div class="card-body">
          
  <p>Eq. 3 $w_a \vec(r)$  (WEIGHTS)
This function calculates the weight of an atom. The weight is defined as the ratio of the partial partition function of the atom to the total partition function. This weight represents the relative importance of the atom.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-rvec~5"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rvec</strong>(3)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iatom~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iAtom</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atcoord~3"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>AtCoord</strong>(3,nAtoms)</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-natoms~5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nAtoms</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~6"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-radius_bs~3"></span>
              real(kind=kind(1d0)),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Radius_BS</strong>(:)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind(1d0))</small>
    </h4>
    

    </div>
  </div>

        </section>
        <br>




    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col"><p>Charge Migration was developed by <br>&copy; 2023 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>